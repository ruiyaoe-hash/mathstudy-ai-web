# Supabase CLI 安装和登录指南

## 安装步骤

### Windows 系统
1. **使用 Scoop 安装**（推荐）：
   ```powershell
   scoop bucket add supabase https://github.com/supabase/scoop-bucket.git
   scoop install supabase
   ```

2. **使用 Winget 安装**：
   ```powershell
   winget install supabase.supabase
   ```

3. **手动安装**：
   - 从 https://github.com/supabase/cli/releases 下载最新的 Windows 版本
   - 解压并将 `supabase.exe` 添加到系统 PATH

### macOS 系统
1. **使用 Homebrew 安装**：
   ```bash
   brew install supabase/tap/supabase
   ```

### Linux 系统
1. **使用包管理器安装**：
   ```bash
   # Debian/Ubuntu
   curl -fsSL https://get.supabase.com/cli/install.sh | sh
   
   # Arch Linux
   yay -S supabase
   ```

## 验证安装
```bash
supabase --version
```

## 登录到 Supabase
1. **启动登录流程**：
   ```bash
   supabase login
   ```

2. **在浏览器中验证**：
   - 命令会打开浏览器并跳转到 Supabase 登录页面
   - 使用你的 Supabase 账号登录
   - 授权 CLI 访问你的 Supabase 项目

3. **验证登录状态**：
   ```bash
   supabase whoami
   ```

## 连接到项目
1. **初始化项目**（如果还没有）：
   ```bash
   supabase init
   ```

2. **链接到现有项目**：
   ```bash
   supabase link --project-ref <your-project-ref>
   ```

## 部署 Edge Functions
登录成功后，你可以部署我们创建的 AI 服务 Edge Function：
```bash
supabase functions deploy ai-service
```

## 环境变量配置
部署前，请确保在 Supabase 控制台中设置了必要的环境变量：
- `ZHIPU_API_KEY`：智谱 AI API 密钥
- `SUPABASE_URL`：你的 Supabase 项目 URL
- `SUPABASE_SERVICE_ROLE_KEY`：服务角色密钥
- `SUPABASE_ANON_KEY`：匿名公共密钥

## 验证部署
部署完成后，你可以测试健康检查端点：
```bash
curl 'https://<your-project>.supabase.co/functions/v1/ai-service?action=health&provider=zhipu' \
  -H 'Authorization: Bearer <your-anon-key>'
```